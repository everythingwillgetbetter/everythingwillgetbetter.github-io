<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>system call | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="什么是系统调用，有何作用？操作系统提供两种服务  面向用户的 命令接口 — 允许用户直接使用  联机命令接口：用户说一句，系统做一句 脱机命令接口：用户说一堆，系统做一堆   面向程序的 程序接口：由一组系统调用组成   “系统调用”是操作系统提供给应用程序（程序员&#x2F;编程人员）使用的接口，可以理解为一种可借应用程序调用的特殊函数， 应用程序可以发出系统调用请求来获得操作系统的服务。  总结：  系">
<meta property="og:type" content="article">
<meta property="og:title" content="system call">
<meta property="og:url" content="http://example.com/2021/01/11/system-call/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="什么是系统调用，有何作用？操作系统提供两种服务  面向用户的 命令接口 — 允许用户直接使用  联机命令接口：用户说一句，系统做一句 脱机命令接口：用户说一堆，系统做一堆   面向程序的 程序接口：由一组系统调用组成   “系统调用”是操作系统提供给应用程序（程序员&#x2F;编程人员）使用的接口，可以理解为一种可借应用程序调用的特殊函数， 应用程序可以发出系统调用请求来获得操作系统的服务。  总结：  系">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2021/01/11/system-call/Stracture.png">
<meta property="og:image" content="http://example.com/2021/01/11/system-call/back.png">
<meta property="article:published_time" content="2021-01-11T08:55:01.000Z">
<meta property="article:modified_time" content="2021-04-18T09:10:45.530Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="system">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2021/01/11/system-call/Stracture.png">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-system-call" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/11/system-call/" class="article-date">
  <time class="dt-published" datetime="2021-01-11T08:55:01.000Z" itemprop="datePublished">2021-01-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      system call
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="什么是系统调用，有何作用？"><a href="#什么是系统调用，有何作用？" class="headerlink" title="什么是系统调用，有何作用？"></a>什么是系统调用，有何作用？</h1><p>操作系统提供两种服务</p>
<ul>
<li><p>面向用户的 命令接口 — 允许用户直接使用</p>
<ul>
<li>联机命令接口：用户说一句，系统做一句</li>
<li>脱机命令接口：用户说一堆，系统做一堆</li>
</ul>
</li>
<li><p>面向程序的 程序接口：由一组系统调用组成</p>
</li>
</ul>
<p>“系统调用”是操作系统提供给应用程序（程序员/编程人员）使用的接口，可以理解为一种可借应用程序调用的特殊函数， <em><strong>应用程序可以发出系统调用请求来获得操作系统的服务。</strong></em> </p>
<p><em><strong>总结：</strong></em></p>
<ol>
<li>系统调用时操作系统提供给应用程序使用的接口</li>
<li>应用程序通过系统调用来请求获得操作系统的服务</li>
<li>系统调用会使处理器从用户态进入核心态</li>
</ol>
<p><em><strong>问题：</strong></em> 操作系统为什么要提供”系统调用”功能？<br><em><strong>答：</strong></em>打印论文并没有混在一起，而是顺序打印</p>
<p><em><strong>问题：</strong></em> 如果各个进程可以随意的使用打印机会怎么样？<br><em><strong>答：</strong></em> 后半段将混合在一起</p>
<p><em><strong>解决方法：</strong></em>操作系统提供”系统调用”功能，用户进程想要使用打印机这种共享资源，只能通过系统调用向操作系统发出请求。操作系统会对各个请求进行协调管理。</p>
<p>应用程序通过系统调用请求操作系统的服务，系统中的各种共享资源都有操作系统统一掌管，因此在用户程序中，凡是与资源有关的操作（如存储分配、I/O操作、文件管理等），都必须通过系统调用的方式向操作系统提出服务请求，由操作系统代为完成。这样可以保证系统的稳定性和安全性，防止用户进行非法操作。</p>
<h2 id="系统调用（按功能分类）"><a href="#系统调用（按功能分类）" class="headerlink" title="系统调用（按功能分类）"></a>系统调用（按功能分类）</h2><ul>
<li>设备管理 - 完成设备的 请求/释放/启动 等功能</li>
<li>文件管理 - 完成文件的 读/写/创建/删除 等功能</li>
<li>进程控制 - 完成进程的 创建/撤销/阻塞/唤醒 等功能</li>
<li>进程通信 - 完成进程间的 消息传递/信号传递 等功能</li>
<li>内存管理 - 完成内存的 分配/回收 等功能呢</li>
</ul>
<p>ps:系统调用相关处理涉及到对系统资源的管理、对进程的控制。这些功能需要执行一些特权指令才能够完成，因此系统调用的相关处理需要在核心态下进行。</p>
<p>ps:凡是与资源有关的操作、会直接影响到其他进程的操作，一定需要操作系统介入，即需要通过系统调用来实现</p>
<h1 id="系统调用和库函数的区别"><a href="#系统调用和库函数的区别" class="headerlink" title="系统调用和库函数的区别"></a>系统调用和库函数的区别</h1><p>&emsp;&emsp;理论上应用程序可以通过汇编语言直接调用硬件系统。但是现在的程序中一般来说都是使用高级语言提供的库函数。但是这些高级语言的低层会封装一些相应的系统调用，只不过细节被库函数屏蔽了，所以使用库函数比较方便，不需要复杂的系统调用。<br>&emsp;&emsp;系统调用的相关处理在核心态进行。</p>
<table>
<thead>
<tr>
<th align="center">普通应用程序</th>
<th align="center">编程语言</th>
<th align="center">操作系统</th>
<th align="center">裸机</th>
</tr>
</thead>
<tbody><tr>
<td align="center">可直接进行系统调用，也可以使用库函数。有的库函数涉及系统调用，有的不涉及</td>
<td align="center">向上提供库函数。有时会将系统调用封装成库函数，以隐藏系统调用的一些细节，使上层进行系统调用更加方便</td>
<td align="center">向上提供系统调用</td>
<td align="center"></td>
</tr>
</tbody></table>
<div style="width:70%;margin:auto"><img src="/2021/01/11/system-call/Stracture.png" class title="This is an Stracture system"></div>

<p><em><strong>不涉及系统调用的库函数：</strong></em> 如取绝对值的函数<br><em><strong>设计系统调用的函数：</strong></em> 如创建一个新的文件函数</p>
<p>ps:系统调用屏蔽了一些对硬件的操作细节，而库函数由进一步屏蔽了一部分的系统调用细节。</p>
<p><em><strong>总结：</strong></em></p>
<ol>
<li>系统调用是操作系统向上层提供的接口</li>
<li>有的库函数是对系统调用的进一步封装</li>
<li>当今编写的应用程序大部分是通过高级语言提供的库函数间接地进行系统调用</li>
</ol>
<h1 id="系统调用背后的过程"><a href="#系统调用背后的过程" class="headerlink" title="系统调用背后的过程"></a>系统调用背后的过程</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">int $0*80  &#x2F;&#x2F; 执行陷入指令，将CPU操作权交给操作系统，之后由操作系统的相关程序，根据指令提供的参数进行相应的处理</span><br><span class="line">movl $4,%eax &#x2F;&#x2F; 将参数放入寄存器</span><br></pre></td></tr></table></figure>

<div style="width:70%;margin:auto"><img src="/2021/01/11/system-call/back.png" class title="This is what in the back"></div>


<p>高级语言视角：调用了一行行的代码，比如说库函数write(“abc”)该库函数内部封装了系统调用的复杂细节<br>汇编语言视角（运行在用户态）：前期处理相关指令 -&gt; movl指令（将”abc”作为系统调用参数放到某个通用寄存器中）-&gt; int x 指令（trap/陷入/访管指令） -&gt; 后续处理相关指令（运行在核心态）</p>
<p>ps: <em><strong>int</strong></em> 指令的参数x指明了系统调用号。此处的int不是整数的意思，其实是interrupt的缩写。不同系统有不同的系统调用号对应不同的指令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#define_NR_exit   1</span><br><span class="line">#define_NR_fork   2   &#x2F;&#x2F;创建一个进程</span><br><span class="line">#define_NR_read   3   &#x2F;&#x2F;进行一个读操作</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p><em><strong>过程：</strong></em></p>
<ol>
<li>传递系统调用参数</li>
<li>执行陷入指令（用户态）</li>
<li>执行系统调用相应服务程序（核心态）</li>
<li>返回用户程序</li>
</ol>
<p><em><strong>注意：</strong></em></p>
<ol>
<li>陷入指令是在用户态执行，执行陷入指令之后立刻引发一个内中断，从而CPU进入核心态</li>
<li>发出系统调用请求是在用户态，而对系统调用的相关处理在核心态下进行</li>
<li>陷入指令是唯一一个只能在用户态下执行，而不可在核心态执行的指令</li>
</ol>
<p>ps：系统调用发生在用户态，对系统调用的处理发生在核心态、执行陷入指令会产生内中断，使处理器从用户态进入核心态。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/01/11/system-call/" data-id="cknn1mv8w002ncrupgxb09rgk" data-title="system call" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/system/" rel="tag">system</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/01/11/Java-day4/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Java day4
        
      </div>
    </a>
  
  
    <a href="/2021/01/11/terminals-and-exceptions/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">terminals and exceptions</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Internet/" rel="tag">Internet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Programming-Language/" rel="tag">Programming Language</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/issues/" rel="tag">issues</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/start-here/" rel="tag">start here</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/system/" rel="tag">system</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/test/" rel="tag">test</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/writing/" rel="tag">writing</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Internet/" style="font-size: 15px;">Internet</a> <a href="/tags/Programming-Language/" style="font-size: 17.5px;">Programming Language</a> <a href="/tags/issues/" style="font-size: 10px;">issues</a> <a href="/tags/start-here/" style="font-size: 12.5px;">start here</a> <a href="/tags/system/" style="font-size: 20px;">system</a> <a href="/tags/test/" style="font-size: 12.5px;">test</a> <a href="/tags/writing/" style="font-size: 10px;">writing</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/04/18/network%20of%20computer2/">network of computer2</a>
          </li>
        
          <li>
            <a href="/2021/04/18/Java%20day1/">Java day1</a>
          </li>
        
          <li>
            <a href="/2021/04/18/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2021/02/25/Java-day19/">Java day19</a>
          </li>
        
          <li>
            <a href="/2021/02/23/Java-day18/">Java day18</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>